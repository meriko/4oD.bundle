PBOX = [
    1966645519, 1842903261, 1735279430, 185977272,
    2791182384, 687742238, 551624498, 800158289,
    1891184188, 1269817151, 4029733166, 3764743866,
    3007847531, 212259780, 3856984951, 2068808754,
    107360463, 1419765407
]

SBOXES = [
    [
        322107106, 1615588600, 3895692219, 3852248189, 1014767972,
        3942490088, 2040678751, 3740081778, 602282695, 747910829,
        3232581532, 8246930, 2725605220, 2345032210, 3068232694,
        3166641725, 3462589153, 151620525, 2628447114, 94443875,
        1334019981, 3438453822, 2400458654, 2639800264, 1994195801,
        499452196, 3518896905, 3942559354, 2666759241, 3371628874,
        3781503693, 3771085817, 2118659342, 68459947, 800913901,
        1458319708, 2225048106, 4204007727, 1379811610, 3489437963,
        3815562536, 4206356762, 4147685502, 1661991663, 500717848,
        4286158565, 53749522, 492305844, 4054159303, 1231113668,
        3984889589, 3843717495, 2026804211, 947023099, 564987559,
        4133504278, 492919138, 553132851, 3622027751, 1220035464,
        3774128452, 2971658276, 769779056, 2306584681, 3831918978,
        1557571750, 4244349798, 323784728, 3309286389, 2784840110,
        2663585926, 3681601025, 1476748709, 490325582, 701265880,
        535304643, 1031500648, 3026557951, 893051881, 1860256694,
        3337229102, 2877504620, 3693512882, 3206539773, 2230846811,
        813536808, 984310731, 1329147208, 3731714359, 3094980704,
        2930212866, 1548020958, 1213213636, 763355013, 1206181438,
        3091548018, 3157576059, 4266065977, 1660823217, 774139100,
        3013649093, 2875638187, 2411097794, 3417008418, 2292982083,
        3173628408, 2355641205, 2886357560, 1732714762, 928201240,
        2360587432, 3955821341, 3515298765, 3182706706, 1512575130,
        2950326596, 1952832557, 341327021, 922179218, 328285208,
        2714854916, 543028903, 3725789889, 955047639, 3671539134,
        281240234, 1995912214, 1126983792, 2054571263, 1290466133,
        2801403028, 3461329936, 3040958743, 1329551545, 1450663931,
        2858398077, 2922876172, 713265161, 1586243767, 3650945640,
        2927224625, 255716231, 3066018718, 1948606125, 4051801833,
        3455198415, 838617646, 3728068932, 271984341, 1970433946,
        927553547, 3819383406, 2382298734, 4235170022, 1475785244,
        3385212537, 1009895150, 2108087674, 3355051454, 450159558,
        1012831100, 2881511429, 3943752525, 1276616133, 466779504,
        2824552894, 2420613679, 125923818, 3809451498, 689182956,
        4117486897, 2515192686, 1940976120, 1184607883, 3283007413,
        3091677791, 1435536816, 1379220096, 874418307, 1674044665,
        885193540, 1178580254, 3606614176, 2833965082, 3748976459,
        61259372, 1872672973, 2894187153, 433249772, 4230031408,
        4020072999, 4231807694, 3877360536, 2279747221, 1421872515,
        2049545749, 3484217200, 1411509005, 2236149095, 1417746782,
        2345504742, 3184153405, 1100861414, 2185866451, 1891586481,
        1783747301, 3578923881, 3187554979, 410923371, 2264631310,
        911556786, 3974828473, 2975252616, 2931849740, 1150611315,
        4189380427, 3716292264, 954519172, 2003887694, 2769320990,
        2301628211, 3933701251, 4148617286, 1747228810, 1818578369,
        3007189578, 1047264621, 2354585646, 2931983021, 738174491,
        596771142, 1513232308, 3307332678, 3328082557, 1425220504,
        1554769067, 925361360, 995880763, 2804938199, 2398127297,
        2694603029, 2844242656, 472646656, 1885226417, 4242710718,
        3909784281, 3291392590, 3382788326, 727618693, 2490257955,
        1755006054, 1917080734, 841610984, 2883399181, 3682988762,
        2751537161
    ], 
    [
        2732283626, 1881850017, 4270558977, 2034340835, 312338714,
        4224144927, 2624331341, 206890925, 111287741, 929211262,
        1847419912, 3594288782, 1370239443, 3260858281, 2788783233,
        2513709369, 187211744, 2369076182, 1506373297, 2964972835,
        2723264026, 1500646979, 365946167, 1431720772, 853740734,
        2720502777, 380585951, 2660395928, 1491307223, 1927718145,
        2059150865, 79832549, 3479682943, 3679643514, 2710423928,
        365809327, 4092118386, 2316571721, 2940027377, 200041891,
        2761912903, 1779681839, 3793903400, 2108881213, 2494002212,
        3318520045, 436116871, 693739297, 3575071693, 2220796483,
        564203445, 3489202014, 3970980697, 2896665767, 2214898433, 
        2655868563, 1706543349, 1537271973, 2939907934, 1491047709,
        3274837211, 936647586, 3186657388, 1049951747, 1285077191, 
        577049771, 2122115658, 1049543434, 1779142527, 951207102, 
        3815681232, 45119203, 576902647, 2280223018, 2197736392, 
        4048213333, 2631855521, 2793165324, 3042790285, 3008190213, 
        3479263780, 746994611, 1737230298, 1476570853, 323699096, 
        3886994962, 3842574074, 1087081211, 2468248362, 3882689791, 
        2835945954, 2372997345, 1036071447, 2829627474, 1102310870, 
        1433855434, 2020693540, 960317852, 2274079567, 3930592802, 
        550410860, 3046167042, 458584893, 3986790730, 2088178313, 
        676090090, 4173610072, 2498235097, 3950795258, 1736575861, 
        3196609633, 166489595, 687606634, 2714567977, 2296102316, 
        2783958308, 4241610490, 2155394653, 745852679, 273322400, 
        1438579921, 1523641174, 1784991060, 3185792295, 795833871, 
        2919641901, 1401575478, 1726477231, 615048790, 63041801, 
        52848614, 2154616134, 2608627319, 1627944590, 1773646296, 
        1412122743, 1719354541, 956741998, 4252333036, 2242093058, 
        1529162839, 6705023, 1215625300, 1680328453, 618707581, 
        1059791371, 401813686, 3271350853, 898606308, 698305079, 
        727372219, 4128869739, 2998510251, 3044735440, 1296391542, 
        1260532769, 2510533012, 496163583, 118880723, 3215834662, 
        3791531053, 368390770, 2985976397, 689075108, 3264162499, 
        2785841156, 2606059232, 2954992742, 2039993461, 2828055776, 
        318141573, 1060960830, 3121252133, 2193268497, 1777598852, 
        1803009691, 1218200164, 129958663, 3215242310, 3321175705, 
        2873700759, 1139715679, 3700711393, 3671554938, 1465934976, 
        3809497502, 395687055, 742494101, 2895236977, 868174410, 
        3448273874, 3364561502, 521417764, 2938493521, 1123686670, 
        373370866, 3580027913, 3687711839, 2428183316, 3134078078, 
        859920044, 3388311248, 1597794316, 2284087152, 1313850437, 
        2862248899, 1959842321, 37137138, 3732824497, 2655948669, 
        2806745538, 3889907968, 2831277618, 3021765245, 2405970503, 
        2420380867, 525555737, 1170339, 960674397, 3270773381, 
        2122253329, 1320994032, 620975843, 526801589, 3382596651, 
        1058258615, 3043535023, 3884221030, 3589108312, 1076552640, 
        3573344846, 3573557344, 599105809, 2800844626, 632888926, 
        1622846952, 958252525, 988572559, 2599860425, 2812683053, 
        1187385533, 1799083765, 2059684727, 247615759, 3991911152, 
        2865185300, 3284831507, 292206901, 2897494656, 767928958, 
        2927344910, 1258530569, 183748377, 3808969438, 67445312, 
        4284863100
    ], 
    [
        1232319536, 1490859152, 1999272277, 1783291039, 1366308662, 
        2488652322, 3711284885, 4176378772, 2052358162, 2088592386, 
        4046943590, 569359152, 852583223, 2053689453, 3699729486, 
        1997294778, 2695668673, 171494539, 1622780575, 2137946030, 
        3614880988, 3670373492, 1866899803, 853813459, 1076998004, 
        3637789593, 3780024933, 3459254657, 1203554417, 3282725800, 
        560537720, 3840980565, 35918339, 2469368566, 2627037897, 
        1912836606, 3617536446, 1540776180, 2185699899, 2083111066, 
        2527152012, 4256770974, 2051892793, 2271818019, 231665053, 
        1292054759, 3112467738, 643228533, 548058968, 2233791516, 
        2461901053, 3092595361, 3634270949, 4224048839, 3916694243, 
        1465111222, 4247056658, 4235374636, 915617536, 2328581673, 
        254585338, 2187316999, 958361182, 3544519371, 3516950025, 
        3505643939, 518603821, 1795280328, 3076030234, 3188387085, 
        3912064437, 4129151643, 1675067251, 3864226065, 3672823638, 
        2108446963, 2546470607, 3847497044, 3992944361, 2406721073, 
        1217135841, 3664550435, 300306478, 3639792304, 859745998, 
        1891006492, 1591459092, 1705580247, 2008278880, 3462389837, 
        2259319909, 276070271, 2087075273, 509395440, 3010264078, 
        108728612, 3966805853, 2914250527, 1433129626, 2795758748, 
        2858043579, 2471749286, 3505466653, 1214632767, 2979997797, 
        3269557985, 1360572549, 316122495, 1825901668, 1456774904, 
        1580869449, 1049168965, 2370747426, 155773186, 1504913559, 
        126118830, 168761667, 2283805816, 320638957, 4131559008, 
        1113066558, 2008401808, 536402105, 3658455033, 3642168650, 
        2399294670, 1548680586, 1943636031, 2902243141, 3441783880, 
        2796543407, 971519314, 2755053940, 3959115705, 2839265404, 
        1550744871, 90636226, 3411094179, 14074314, 1228903112, 
        712394719, 1174109140, 847351319, 2003531958, 236327184, 
        1652252299, 3665390882, 2758916417, 3073843034, 1437480132, 
        2454508076, 3287355622, 2093309677, 736960718, 1415083097, 
        3740633494, 2886609839, 1056726318, 2087845176, 1420810685, 
        2845583912, 717615943, 1130377876, 3916141432, 3152692290, 
        3341221675, 380367631, 2624847247, 4173337160, 4227130531, 
        551729305, 1471707610, 685764975, 1508777431, 420380620, 
        1582759730, 4278103228, 1382086825, 1564283952, 3634375519, 
        4215005575, 2320496963, 2365961748, 3808936273, 2108299756, 
        3627183225, 2183947109, 3665988270, 2720051220, 543537788, 
        4149776274, 1963911095, 1890732170, 3586632347, 1971303795, 
        2791586447, 1856275739, 333107144, 3816246140, 2302408301, 
        3285175165, 1178439438, 4282499833, 1182993257, 3957020384, 
        2502755941, 1794111475, 2530165207, 4178665898, 1248244563, 
        2394217239, 2591159826, 840370262, 2296986306, 696225539, 
        968333739, 862422846, 3219111696, 334416577, 4122114458, 
        2547270264, 2233985288, 3841698374, 2673713756, 17121412, 
        995920934, 2146393614, 1023526116, 234722795, 3942022466, 
        689985131, 1905924953, 2252195160, 1819143800, 2005330494, 
        2204465968, 1599748775, 1731278779, 1263205328, 3109607179, 
        1248723932, 2326727943, 2326616566, 1154801902, 468931281, 
        3271156881, 583244270, 512967450, 1294859191, 2889152559, 
        3244354524, 1384883232, 1789390792, 3828168258, 1157355502, 
        3498217986
    ],
    [
        302934754, 3930867676, 3635334036, 387764748, 1335578335, 
        1304728341, 338486281, 1360133004, 3927077119, 308338747, 
        730071719, 820329392, 2214311544, 1316271757, 2028694709, 
        663408474, 768875525, 3114655763, 205128433, 255265888, 
        3310688640, 107833724, 2909285624, 2050416713, 2228679763, 
        1084007563, 566091416, 337306710, 161942490, 3750301233, 
        137723821, 2301964342, 3052527341, 3533333707, 874416510, 
        1886363880, 3868076106, 3012795696, 866118442, 2743585457, 
        448422474, 1801338637, 491713092, 2986108817, 2475309478, 
        256871068, 4222067040, 697940756, 2958171578, 1323622067, 
        665279409, 1540119845, 697185990, 2366422874, 2353862902, 
        4156768413, 1190775386, 392797026, 3167943999, 754028324, 
        3202056547, 3456722914, 2538208676, 3510439695, 3019697411, 
        3060716176, 223007131, 905484639, 1466457667, 1377305662, 
        1016169351, 2445704505, 3138058419, 3036912246, 1530741499, 
        905887613, 2426454008, 3689533845, 2583247897, 558249771, 
        1335129231, 1721376862, 3811051185, 3421783006, 856286258, 
        371837918, 2680571083, 267184256, 1198200871, 226240314, 
        2629315724, 1973584696, 1689801611, 1488266139, 1711230737, 
        3199213968, 2318960935, 234885099, 76929866, 2537291602, 
        2881042101, 1450814079, 711264571, 1029943502, 3363508725, 
        1202889035, 3619010632, 290154553, 2140742295, 3028085334, 
        610634778, 2778410796, 3625178077, 3826581853, 1520510297, 
        3165349702, 4129994007, 2769081705, 2708692784, 4279500023, 
        3417932003, 3376634079, 3307722953, 3926278365, 480674134, 
        2866960647, 2758457829, 2166200022, 3120225009, 791630152, 
        1453270577, 3620490255, 4204347121, 279076200, 3091065878, 
        3456006802, 3829336763, 889886250, 2961542482, 4079508675, 
        3606817885, 1007382946, 1671761109, 4226595995, 3320040084, 
        181465934, 2088653448, 1716522329, 4088630516, 806095990, 
        1922842076, 1329879178, 1030049473, 1217359083, 3774768556, 
        362116611, 3515067376, 2146607601, 642537673, 4107545581, 
        463300477, 2058837892, 1642159599, 4138381434, 2764639421, 
        3687250455, 515126730, 3752099035, 2931192473, 3489771593, 
        3491728278, 3668720754, 2893891379, 485356198, 3852250422, 
        1037523518, 585085111, 1435012885, 3749357512, 2241720530, 
        1067108656, 619795464, 1698139972, 1158118674, 940352182, 
        1829484365, 3607118939, 995039109, 2366246683, 2350718707, 
        1117400780, 2803118573, 2053435842, 991080827, 1400336452, 
        2995254101, 3989824385, 1102264769, 3045884380, 4107626590, 
        3688085238, 2787544880, 1037180091, 2129218837, 1855397679, 
        2198961108, 540494225, 4079152168, 4187353772, 4275948869, 
        3425371781, 3109953944, 357967547, 2536987495, 4227598267, 
        420751830, 1393034734, 3735446211, 2966524748, 1570256156, 
        907605289, 2080611630, 933242011, 959905844, 4206284256, 
        2034556145, 3664675891, 2559172953, 1404126621, 1485716234, 
        3392550633, 3785280259, 4097045912, 4010856847, 429082987, 
        2888105914, 2672165798, 2409590648, 3570670506, 1732180662, 
        3328961235, 2934458193, 2187606611, 2848252053, 1030518441, 
        3344280224, 2571710734, 143963752, 4251595609, 1168461815, 
        733683543, 1793250471, 2309372134, 2640588999, 2205399820, 
        1928071642
    ]
]

BLOCK_SIZE = 8

def Decode(data):
    data = String.Base64Decode(data)      
    decoded = []
    
    for i in range(0, len(data), BLOCK_SIZE):
        block = data[i : i + BLOCK_SIZE]
        
        xl = ord(block[3]) | (ord(block[2]) << 8) | (ord(block[1]) << 16) | (ord(block[0]) << 24)
        xr = ord(block[7]) | (ord(block[6]) << 8) | (ord(block[5]) << 16) | (ord(block[4]) << 24)

        for j in range (17, 1, -1):
            xl = xl ^ PBOX[j]
            
            f = ((SBOXES[0][(xl >> 24) & 0xFF] + \
                SBOXES[1][(xl >> 16) & 0xFF]) ^ \
                SBOXES[2][(xl >> 8) & 0xFF]) + \
                SBOXES[3][xl & 0xFF] 
                
            f = f & 0xFFFFFFFF
        
            xr = f ^ xr
            xl, xr = xr, xl
            
        xl, xr = xr, xl
        
        xr = xr ^ PBOX[1]
        xl = xl ^ PBOX[0]
        
        decoded.extend(
            (
                (xl >> 24) & 0xFF,
                (xl >> 16) & 0xFF,
                (xl >> 8) & 0xFF,
                xl & 0xFF,
                (xr >> 24) & 0xFF,
                (xr >> 16) & 0xFF,
                (xr >> 8) & 0xFF,
                xr & 0xFF
            )
        )

    length = decoded[len(decoded) - 1]
    decoded = decoded[:len(decoded) - length]
    pt = ''.join([chr(x) for x in decoded])
    
    return pt

        
        
        
    
        
